---
title: "Haskellã§ã‚ªãƒ¬ã‚ªãƒ¬Language Serverã‚’æ›¸ã"
emoji: "ğŸƒ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["haskell", "vscode"]
published: true
---

ã“ã®è¨˜äº‹ã§ã¯Haskellã‚’ä½¿ã£ã¦ç°¡å˜ãªLanguage Server(LS)ã‚’å®Ÿè£…ã—ã¾ã™ã€‚ã•ã‚‰ã«ã€ãã‚Œã«å¯¾å¿œã™ã‚‹vscodeã®æ‹¡å¼µæ©Ÿèƒ½ã®å®Ÿè£…ã¨ãƒ‡ãƒãƒƒã‚°ç’°å¢ƒã®æ•´å‚™ã‚’è¡Œã„ã¾ã™ã€‚LSã®å®Ÿè£…ã¯Haskellç‰¹æœ‰ã®ã‚‚ã®ã§ã™ãŒã€vscodeã®æ‹¡å¼µæ©Ÿèƒ½ã®è©±ã¯ã»ã‹ã®è¨€èªã«ã‚‚å¿œç”¨ã§ãã‚‹ã¯ãšã§ã™ã€‚

ã“ã®è¨˜äº‹ã§ä½¿ã£ãŸã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®ãƒªãƒã‚¸ãƒˆãƒªã«ã‚ã‚Šã¾ã™ã€‚

https://github.com/Hagihara-A/oreore-ls

# Language Serverã®å®Ÿè£…

Haskellã§LSã‚’å®Ÿè£…ã™ã‚‹ã«ã¯[lsp](https://github.com/haskell/lsp)ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç”¨ã„ã¾ã™ã€‚lspãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ä»¥ä¸‹ã®3ã¤ã«åˆ†ã‹ã‚Œã¦ã„ã¾ã™ã€‚

1. lsp
   - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚„ã‚Šå–ã‚Šã‚„Virtual File System(VFS)ãªã©ã®LSã®å®Ÿæ…‹ã‚’å®Ÿè£…ã—ã¦ã„ã‚‹ã€‚
2. lsp-types
   - Language Server Protocol(LSP)ã§ç”¨ã„ã‚‰ã‚Œã‚‹å¤§é‡ã®ãƒ‡ãƒ¼ã‚¿å‹ã®å®šç¾©ãªã©ã‚’ã—ã¦ã„ã‚‹ã€‚Lensã‚‚åŒæ¢±ã•ã‚Œã¦ã„ã¦å¤§å¤‰ä¾¿åˆ©ã€‚
3. lsp-test
   - LSPã®ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚‰ã—ã„ã€‚ä½¿ã£ãŸã“ã¨ãŒãªã„ã®ã§ã‚ˆãã‚ã‹ã‚‰ãªã„ã€‚

ã“ã®è¨˜äº‹ã§ã¯stackageã®[lts-22.43](https://www.stackage.org/lts-22.43)ã‚’ç”¨ã„ã¾ã™ã€‚lts-22.43ã®lspã¯2.3.0.0ã€lsp-typesã¯2.1.1.0ã§ã™ã€‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«æ°—ã‚’ä»˜ã‘ã¦ãã ã•ã„ã€‚

ã„ããªã‚Šã§ã™ãŒã€LSã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã§ã™ã€‚GitHubã®[lsp/exampleãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª](https://github.com/haskell/lsp/blob/lsp-2.3.0.0/lsp/example/Simple.hs)ã«ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ãŒã‚ã‚Šã¾ã™ã€‚

```hs
{-# LANGUAGE DuplicateRecordFields #-}
{-# LANGUAGE LambdaCase #-}
{-# LANGUAGE OverloadedStrings #-}

import Control.Monad.IO.Class
import Data.Text qualified as T
import Language.LSP.Protocol.Message
import Language.LSP.Protocol.Types
import Language.LSP.Server

handlers :: Handlers (LspM ())
handlers =
  mconcat
    [ notificationHandler SMethod_Initialized $ \_not -> do
        let params =
              ShowMessageRequestParams
                MessageType_Info
                "Turn on code lenses?"
                (Just [MessageActionItem "Turn on", MessageActionItem "Don't"])
        _ <- sendRequest SMethod_WindowShowMessageRequest params $ \case
          Right (InL (MessageActionItem "Turn on")) -> do
            let regOpts = CodeLensRegistrationOptions (InR Null) Nothing (Just False)

            _ <- registerCapability SMethod_TextDocumentCodeLens regOpts $ \_req responder -> do
              let cmd = Command "Say hello" "lsp-hello-command" Nothing
                  rsp = [CodeLens (mkRange 0 0 0 100) (Just cmd) Nothing]
              responder $ Right $ InL rsp
            pure ()
          Right _ ->
            sendNotification SMethod_WindowShowMessage (ShowMessageParams MessageType_Info "Not turning on code lenses")
          Left err ->
            sendNotification SMethod_WindowShowMessage (ShowMessageParams MessageType_Error $ "Something went wrong!\n" <> T.pack (show err))
        pure ()
    , requestHandler SMethod_TextDocumentHover $ \req responder -> do
        let TRequestMessage _ _ _ (HoverParams _doc pos _workDone) = req
            Position _l _c' = pos
            rsp = Hover (InL ms) (Just range)
            ms = mkMarkdown "Hello world"
            range = Range pos pos
        responder (Right $ InL rsp)
    ]

main :: IO Int
main =
  runServer $
    ServerDefinition
      { parseConfig = const $ const $ Right ()
      , onConfigChange = const $ pure ()
      , defaultConfig = ()
      , configSection = "demo"
      , doInitialize = \env _req -> pure $ Right env
      , staticHandlers = \_caps -> handlers
      , interpretHandler = \env -> Iso (runLspT env) liftIO
      , options = defaultOptions
      }
```

ã“ã®LSã«ã¯2ã¤ã®æ©Ÿèƒ½ãŒã‚ã‚Šã¾ã™ã€‚

ã¾ãš1ã¤ã‚ãŒã€LSãŒèµ·å‹•ã•ã‚ŒãŸã¨ãã« LCã«`Turn on code lenses?`ã¨ã„ã†ã‚¿ã‚¤ãƒˆãƒ«ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚Šã€`Turn on`ãŒé¸æŠã•ã‚Œã‚Œã°CodeLensã‚’æœ‰åŠ¹ã«ã—ã€ãã‚Œä»¥å¤–ãªã‚‰ç„¡åŠ¹ã«ã™ã‚‹ã‚‚ã®ã§ã™ã€‚ã“ã‚Œã¯LSãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã„ã€LCãŒLSã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã—ã¾ã™ã€‚

2ã¤ç›®ãŒã€LCã‹ã‚‰TextHoverãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæ¥ãŸæ™‚ã«`Hello world`ã¨ã„ã†å›ºå®šå€¤ã®markdownãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™ã‚‚ã®ã§ã™ã€‚ã“ã‚Œã¯LCèµ·ç‚¹ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã€LSã¯LCã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã—ã¾ã™ã€‚LSPã§ä¸€èˆ¬çš„ã«æƒ³åƒã•ã‚Œã‚‹Completionã‚„Diagnosticsãªã©ã¯ã“ã®å½¢å¼ãªã®ã§ã€é¦´æŸ“ã¿ã‚„ã™ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

## LS ã®ãƒ†ã‚¹ãƒˆ

ä½œã£ãŸLSã‚’å®Ÿéš›ã«å‹•ã‹ã—ã¦ã¿ã¾ã™ã€‚ä»¥ä¸‹ã®å†…å®¹ã‚’é©å½“ãªãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã—ã¦ãã ã•ã„ã€‚ã“ã®æ™‚æ”¹è¡Œã‚³ãƒ¼ãƒ‰ãŒ**CRLF**ã«ãªã‚‹ã‚ˆã†ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚vscodeãªã‚‰å³ä¸‹ã®ãƒœã‚¿ãƒ³ã‹ã‚‰å¤‰æ›´ã§ãã¾ã™ã€‚

```json:test.txt
Content-Length: 162

{
	"jsonrpc": "2.0",
	"id": 1,
	"method": "initialize",
	"params": {
        "processId": 123,
        "rootUri": null,
        "capabilities": {}
	}
}
Content-Length: 54

{
	"jsonrpc": "2.0",
	"id": 2,
	"method": "exit"
}
```

ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’`stack run < test.txt`ãªã©ã¨ã—ã¦LSã«ä¸ãˆã‚‹ã¨

```
[Info] Starting server
[Info] LSP: Got exit, exiting
```

ã¨ã„ã†å‡ºåŠ›ãŒå¾—ã‚‰ã‚Œã€LSãŒæ­£å¸¸ã«èµ·å‹•ã¨çµ‚äº†ã‚’ã—ãŸã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚åŸç†çš„ã«ã¯ã“ã®ã‚ˆã†ã«LSPã‚’æ‰‹æ›¸ãã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

# Language Clientã®å®Ÿè£…

Language Client(LC)ã¨ã¯ã€LSã¨LSPã§é€šä¿¡ã‚’è¡Œã„ã€å„ã‚¨ãƒ‡ã‚£ã‚¿å‘ã‘ã®è¨€èªæ”¯æ´ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã®ã“ã¨ã§ã™ã€‚vscodeã§ã„ã†ã¨extensionã«ãªã‚Šã¾ã™ã€‚å›³ã«ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```mermaid
graph TB
A[vscode] <-->|vscode API| B["vscode extension(LC)"]
B <-->|LSP| C[languge server]
```

ã¨ã„ã†ã“ã¨ã§ã€vscodeã®æ‹¡å¼µæ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚vscodeã§LSPã‚’ç”¨ã„ãŸextensionã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ãŠã‚‚ã«[ã“ã“](https://code.visualstudio.com/api/language-extensions/language-server-extension-guide)ã‚’è¦‹ã‚Œã°ã‚ˆã„ã§ã—ã‚‡ã†ã€‚ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯é•·ã„ã®ã§ã™ãŒã€é£›ã°ã—é£›ã°ã—èª­ã‚“ã§ã„ã‚‹ã¨ã€Œãšã£ã¨æ‚©ã‚“ã§ãŸã“ã®ä»•æ§˜ã€ã“ã“ã«ã‹ã„ã¦ã‚‹ã‚„ã‚“ã‘ãƒ»ãƒ»ãƒ»ã€ã¨ãªã‚‹ã®ã§çœŸé¢ç›®ã«èª­ã¿ã¾ã—ã‚‡ã†ï¼ˆè‡ªæˆ’ï¼‰ã€‚

vscodeã®extension(ä»¥å¾Œvsceã¨ç•¥)ã¯npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦å®Ÿè£…ã•ã‚Œã¾ã™ã€‚ã¾ãšã¯package.jsonã‚’ä½œã‚Šã¾ã™ã€‚ä»¥ä¸‹ãŒæœ€ä½é™å¿…è¦ãªå†…å®¹ã§ã™ã€‚å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã¯[ã“ã“](https://code.visualstudio.com/api/references/extension-manifest)ã«ã‚ã‚Šã¾ã™ã€‚

```json:package.json
{
  "name": "lsp-sample",
  "description": "A language server example",
  "version": "1.0.0",
  "engines": {
    "vscode": "^1.75.0"
  },
  "main": "./out/extension",
  "activationEvents": [
    "onLanguage:plaintext"
  ],
  "dependencies": {
    "vscode-languageclient": "^9.0.1"
  },
  "devDependencies": {
    "@types/node": "^20",
    "@types/vscode": "^1.88.0",
    "typescript": "^5.4.5"
  }
}
```

æ¬¡ã«vsceã®æœ¬ä½“ã‚’å®Ÿè£…ã—ã¾ã™ã€‚ä»¥ä¸‹ãŒå®Ÿè£…ã«ãªã‚Šã¾ã™ã€‚

```ts:src/extension.ts
import { workspace, ExtensionContext } from "vscode";

import {
  LanguageClient,
  LanguageClientOptions,
  ServerOptions,
  TransportKind,
} from "vscode-languageclient/node";

let client: LanguageClient;

export function activate(context: ExtensionContext) {
  const opt = {
    command: "stack",
    args: ["run", "--"],
    transport: TransportKind.stdio,
    options: {
      cwd: "/home/arark/oreore-ls/server",
    },
  };
  const serverOptions: ServerOptions = {
    run: opt,
    debug: opt,
  };

  const clientOptions: LanguageClientOptions = {
    documentSelector: [{ scheme: "file", language: "plaintext" }],
  };

  client = new LanguageClient(
    "languageServerExample",
    "Language Server Example",
    serverOptions,
    clientOptions
  );

  client.start();
}
```

ã¾ãš`serverOptions`ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚ServerOptionsã¯LSã®èµ·å‹•ã‚’åˆ¶å¾¡ã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚ä¸Šè¨˜ã®è¨­å®šã ã¨

1. `/home/arark/oreore-ls/server`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§`stack run --`ã‚’å®Ÿè¡Œã—ã¦LSã‚’èµ·å‹•
2. èµ·å‹•ã—ãŸLSã®ãƒ—ãƒ­ã‚»ã‚¹ã¨stdioã§é€šä¿¡

ã¨ãªã‚Šã¾ã™ã€‚ã“ã®å®Ÿè£…ã§ã¯cwdã‚’æ±ºã‚æ‰“ã¡ã§æŒ‡å®šã—ã¦`stack run`ã§èµ·å‹•ã—ã¾ã—ãŸãŒã€å®Ÿéš›ã«ã¯LSã®å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¢ã—ãŸã‚Šãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã‚‹å‡¦ç†ãŒå¿…è¦ãªã¯ãšã§ã™ã€‚

ã¡ãªã¿ã«`vscode-languageclient`ã¯TransportKindã«å¿œã˜ã¦argsã‚’æ‹¡å¼µã™ã‚‹ã®ã§ã€`stack run --`ã®æœ€å¾Œã®ãƒã‚¤ãƒ•ãƒ³ãŒå¿…è¦ã«ãªã£ã¦ã„ã¾ã™ã€‚ä¾‹ãˆã°pipeã§èµ·å‹•ã™ã‚Œã°`--pipe=/run/user/1000/`ãŒargsã®æœ«å°¾ã«è¿½åŠ ã•ã‚Œã¾ã™ã€‚

`clientOptions`ã¯ã“ã®extensionãŒç›£è¦–ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚ã“ã®æŒ‡å®šã§ã¯plaintextã®ã¨ãã®ã¿LCãŒLSã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚Šã¾ã™ã€‚

## Extensionã®èµ·å‹•

æ¬¡ã«å®Ÿè£…ã—ãŸextensionã‚’èµ·å‹•ã—ã¦ã¿ã¾ã™ã€‚ãƒ­ãƒ¼ã‚«ãƒ«ã§é–‹ç™ºã—ãŸextensionã®èµ·å‹•ã«ã¯vscodeã®ãƒ‡ãƒãƒƒã‚¬ã‚’ç”¨ã„ã¾ã™ã€‚æ‰‹å…ƒã§vsceã‚’ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°ã—ã¦vscodeã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ã§èµ·å‹•ã™ã‚‹ã®ã‚‚å¯èƒ½ãªã¯ãšã§ã™ãŒã€ã“ã¡ã‚‰ã®ã»ã†ãŒç°¡å˜ã§ã™ã€‚

ãƒ‡ãƒãƒƒã‚¬ã‚’ä½¿ã†ã®ã§`launch.json`ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”¨æ„ã—ã¦ãã ã•ã„ã€‚

```json:.vscode/launch.json
{
    "version": "0.2.0",
    "configurations": [
        {
            "type": "extensionHost",
            "request": "launch",
            "name": "Launch Client",
            "runtimeExecutable": "${execPath}",
            "args": [
                "--extensionDevelopmentPath=${workspaceRoot}"
            ],
            "outFiles": [
                "${workspaceRoot}/client/out/**/*.js"
            ],
            "autoAttachChildProcesses": true
        }
    ]
}
```

ãƒ‡ãƒãƒƒã‚¬ã¨launch.jsonã®ä»•æ§˜ã«ã¤ã„ã¦ç­†è€…ãŒè©³ã—ããªã„ã®ã§ã™ãŒã€ã¨ã‚Šã‚ãˆãšã“ã‚ŒãŒã‚ã‚Œã°å‹•ãã¾ã™ã€‚Debugç”¨ã®extensionã”ã¨ã«ãã‚Œãã‚Œãƒ¦ãƒ‹ãƒ¼ã‚¯ãª`type`ã‚’æŒã£ã¦ã„ã‚‹ãŸã‚ã€`"type": "extensionHost"`ã§ã“ã®launch.jsonã‚’è§£é‡ˆã™ã‚‹extensionã‚’æŒ‡å®šã—ã¦ã„ã‚‹ã¿ãŸã„ã§ã™ã€‚extensionHostã¨ã¯vsceã‚’ç®¡ç†ã™ã‚‹ãƒã‚¹ã‚¿ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹(?)ã¿ãŸã„ãªã‚‚ã®ã§ã™ã€‚å¤šåˆ†ã€‚ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯[ã“ã¡ã‚‰](https://code.visualstudio.com/api/advanced-topics/extension-host)ã€‚

ãªãŠã€é–‹ç™ºã—ãŸextensionãŒworkspaceã®ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã«ãªãã¦ã‚‚ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¾ã§package.jsonã‚’æ¢ã—ã«ã„ã£ã¦ãã‚Œã‚‹ã¿ãŸã„ã§ã™ã€‚

ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã£ãŸçŠ¶æ…‹ã§vscodeã®ãƒ‡ãƒãƒƒã‚°ã‚¿ãƒ–ã‚’é–‹ã„ã¦ã€Œãƒ‡ãƒãƒƒã‚°ã®å®Ÿè¡Œã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã‹ã€F5ã‚’æŠ¼ã™ã¨ã€åˆ¥ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§extensionãŒèµ·å‹•ã—ã¾ã™ã€‚TypeScriptã«SourceMapã‚’å‡ºåŠ›ã•ã›ã‚‹ã¨TSã®ãƒ•ã‚¡ã‚¤ãƒ«ä¸Šã§ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’æŒ‡å®šã§ãã‚‹ã®ã§ä¾¿åˆ©ã§ã™ã€‚

æ­£ã—ãèµ·å‹•ã§ãã¦ã„ã‚Œã°ã€åˆ¥ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé–‹ãã¨"Turn on code lenses?"ã¨ã„ã†é€šçŸ¥ãŒè¡¨ç¤ºã•ã‚Œã€ãƒ†ã‚­ã‚¹ãƒˆã«ãƒ›ãƒãƒ¼ã™ã‚‹ã¨`Hello world`ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã¯ãšã§ã™ã€‚

ã“ã®æ–¹æ³•ã§é–‹ç™ºã—ãŸextensionã®ãƒ‡ãƒãƒƒã‚°ã‚’ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ‡ãƒãƒƒã‚¬ã®ä½¿ã„æ–¹ã¯é€šå¸¸ã¨åŒã˜ã§ã™ã€‚

## LSPã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¡¨ç¤º
ã“ã“ã¾ã§ã§ãƒ‡ãƒãƒƒã‚¬ã‚’ç”¨ã„ã¦extensionã‚’èµ·å‹•ã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚ã—ã‹ã—vsceã®é–‹ç™ºã§ã¯ã€LSã¨LCã§ã‚„ã‚Šå–ã‚Šã—ã¦ã„ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç›®è¦–ã§ç¢ºèªã—ãŸã„ã¨ã„ã†ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚`vscode-languageclient`ã¯ã“ã®æ©Ÿèƒ½ã‚’çµ„ã¿è¾¼ã¿ã§æä¾›ã—ã¦ã„ã¾ã™ã€‚

package.jsonã«ä»¥ä¸‹ã®è¨­å®šã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚

```diff json:package.json
{
  "name": "lsp-sample",
  "version": "1.0.0",
+  "contributes": {
+    "configuration": {
+      "type": "object",
+      "title": "Example configuration",
+      "properties": {
+        "languageServerExample.trace.server": {
+          "scope": "window",
+          "type": "string",
+          "enum": [
+            "off",
+            "messages",
+            "verbose"
+          ],
+          "default": "verbose",
+          "description": "Traces the communication between VS Code and the language server."
+        }
+      }
+    }
+  },
}
```

`[langID].trace.server`ã‚’`verbose`ã«ã™ã‚‹ã¨ã€`vscode-languageclient`ãŒã“ã®è¨­å®šã‚’å‹æ‰‹ã«èª­ã¿è¾¼ã‚“ã§LSPã§ã‚„ã‚Šå–ã‚Šã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ­ã‚°ã«åãã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚extensionã®ãƒ­ã‚°ã¯ã€å‡ºåŠ›ã‚¿ãƒ–ã®Language Server Exampleã‹ã‚‰è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚


# ã¾ã¨ã‚
ä»¥ä¸Šã§Haskellã§LSã‚’å®Ÿè£…ã—ã€ãã‚Œã«å¯¾å¿œã™ã‚‹vsceã®å®Ÿè£…ã¨ãƒ‡ãƒãƒƒã‚°ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã—ãŸã€‚ã¿ãªã•ã‚“ã‚‚ã‚ªãƒ¬ã‚ªãƒ¬LSã‚’å®Ÿè£…ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼