---
title: "JavaScriptã§å·¨å¤§ãªé™çš„é…åˆ—ã‚’å®Ÿè£…ã™ã‚‹ã¨ãã¯switchã‚ˆã‚Šã‚‚arrayã‚’ä½¿ã£ãŸã»ã†ãŒæ™®é€šã«ã¯ã‚„ã„"
emoji: "ðŸ¥"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["javascript", "typescript"]
published: true
---

# å‹•æ©Ÿ
JSã§äº‹å‰ã«å€¤ãŒæ±ºã¾ã£ã¦ã„ã‚‹å·¨å¤§ãªé™çš„é…åˆ—ã‚’å®Ÿè£…ã™ã‚‹ã¨ãã«ã€arrayã˜ã‚ƒãªãã¦switchã®æ–¹ãŒæ—©ã„ã¨æ€ã£ãŸã®ã§ãƒ™ãƒ³ãƒã‚’ã¨ã£ãŸã€‚Denoã§ã‚„ã£ãŸã®ã§V8ã®ãƒ™ãƒ³ãƒã«ãªã‚‹ã€‚

# å®Ÿé¨“
ãƒ™ãƒ³ãƒãƒžãƒ¼ã‚¯ã‚’ä½œã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€‚
```ts
await Deno.remove("array_switch.ts");
const Ns = [100, 1000, 10000];
for (const N of Ns) {
  const array_banch: string = `const arr${N} = [${Array.from(
    { length: N },
    (_, i) => i
  ).join(",")}];
const get_val_array${N} = (i: number) => {
    return arr${N}[i];
};
Deno.bench(
    "array_${N}",
    () => {
      for (let i = 0; i < 10000; i++) {
        get_val_array${N}(i);
      }
}
   )`;
  const switch_bench: string = `
const get_val_switch${N} = (i: number) => {
    switch (i) {
      ${Array.from({ length: N }, (_, i) => `case ${i}: return ${i};`).join(
        "\n"
      )}
    }}
Deno.bench(
      "switch_${N}",
      () => {
        for (let i = 0; i < 10000; i++) {
          get_val_switch${N}(i);
        }
    })
`;
  Deno.writeTextFile(`array_switch.ts`, array_banch, {
    append: true,
  });
  Deno.writeTextFile(`array_switch.ts`, switch_bench, {
    append: true,
  });
}
```

# ãƒ™ãƒ³ãƒã®å®Ÿè¡Œçµæžœ

```
benchmark      time/iter (avg)        iter/s      (min â€¦ max)           p75      p99     p995
-------------- ----------------------------- --------------------- --------------------------
array_100               4.8 Âµs       207,000 (  4.7 Âµs â€¦   5.1 Âµs)   4.9 Âµs   5.1 Âµs   5.1 Âµs
switch_100             17.8 Âµs        56,030 (  8.2 Âµs â€¦ 322.9 Âµs)  16.3 Âµs  59.3 Âµs  76.8 Âµs
array_1000              5.0 Âµs       198,100 (  4.6 Âµs â€¦   1.8 ms)   4.7 Âµs   8.4 Âµs  20.9 Âµs
switch_1000            60.5 Âµs        16,530 ( 55.5 Âµs â€¦ 437.3 Âµs)  57.7 Âµs 121.3 Âµs 149.7 Âµs
array_10000             4.6 Âµs       218,000 (  4.4 Âµs â€¦   5.2 Âµs)   4.6 Âµs   5.2 Âµs   5.2 Âµs
switch_10000          257.6 Âµs         3,881 (202.7 Âµs â€¦   3.0 ms) 257.3 Âµs 480.0 Âµs 585.6 Âµs
```

# æ„Ÿæƒ³
å‹•çš„ãªarrayã‚ˆã‚Šã‚‚é™çš„ãªswitchã®æ–¹ãŒæ—©ã„ã¨æ€ã£ãŸãŒã€çµæžœã¯é€†ã ã£ãŸã€‚arrayã¯å®šæ•°æ™‚é–“ã§è¦ç´ ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã®ã«å¯¾ã—ã¦ã€switchã¯ã»ã¼è¦ç´ æ•°ã«æ¯”ä¾‹ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹æ™‚é–“ãŒä¼¸ã³ã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆã‚‹ã€‚