---
title: "JavaScriptã§å·¨å¤§ãªé™çš„é…åˆ—ã‚’å®Ÿè£…ã™ã‚‹ã¨ãã¯switchã‚ˆã‚Šã‚‚arrayã‚’ä½¿ã£ãŸã»ã†ãŒæ™®é€šã«ã¯ã‚„ã„"
emoji: "ðŸ¥"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["javascript", "typescript"]
published: true
---

# å‹•æ©Ÿ
JSã§å·¨å¤§ãªäº‹å‰ã«å€¤ãŒæ±ºã¾ã£ã¦ã„ã‚‹é™çš„é…åˆ—ã‚’å®Ÿè£…ã™ã‚‹ã¨ãã«ã€Arrayã˜ã‚ƒãªãã¦switchã®æ–¹ãŒæ—©ã„ã¨æ€ã£ãŸã®ã§ãƒ™ãƒ³ãƒã‚’ã¨ã£ãŸã€‚Denoã§ã‚„ã£ãŸã®ã§v8ã®ãƒ™ãƒ³ãƒã«ãªã‚‹ã€‚

# å®Ÿé¨“
ãƒ™ãƒ³ãƒãƒžãƒ¼ã‚¯ã‚’ä½œã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€‚
```ts
await Deno.remove("array_switch.ts");
const Ns = [100, 1000, 10000];
for (const N of Ns) {
  const array_banch: string = `const arr${N} = [${Array.from(
    { length: N },
    (_, i) => i
  ).join(",")}];
const get_val_array${N} = (i: number) => {
    return arr${N}[i];
};
Deno.bench(
    "array_${N}",
    () => {
      for (let i = 0; i < ${N}; i++) {
        get_val_array${N}(i);
      }
}
   )`;
  const switch_bench: string = `
const get_val_switch${N} = (i: number) => {
    switch (i) {
      ${Array.from({ length: N }, (_, i) => `case ${i}: return ${i};`).join(
        "\n"
      )}
    }}
Deno.bench(
      "switch_${N}",
      () => {
        for (let i = 0; i < ${N}; i++) {
          get_val_switch${N}(i);
        }
    })
`;
  Deno.writeTextFile(`array_switch.ts`, array_banch, {
    append: true,
  });
  Deno.writeTextFile(`array_switch.ts`, switch_bench, {
    append: true,
  });
}
```

# ãƒ™ãƒ³ãƒã®å®Ÿè¡Œçµæžœ

```
benchmark      time/iter (avg)        iter/s      (min â€¦ max)           p75      p99     p995
-------------- ----------------------------- --------------------- --------------------------
array_100              51.9 ns    19,280,000 ( 49.1 ns â€¦ 152.8 ns)  51.0 ns  89.2 ns  98.1 ns
switch_100            101.9 ns     9,810,000 ( 85.9 ns â€¦ 247.6 ns)  96.0 ns 200.3 ns 218.8 ns
array_1000            490.3 ns     2,040,000 (456.7 ns â€¦ 760.9 ns) 495.3 ns 644.7 ns 760.9 ns
switch_1000            17.7 Âµs        56,620 ( 15.1 Âµs â€¦ 506.1 Âµs)  17.3 Âµs  46.0 Âµs  67.9 Âµs
array_10000             4.9 Âµs       202,300 (  4.6 Âµs â€¦   5.7 Âµs)   5.0 Âµs   5.7 Âµs   5.7 Âµs
switch_10000          274.4 Âµs         3,644 (213.4 Âµs â€¦   3.1 ms) 268.8 Âµs 582.3 Âµs 617.0 Âµs
```

# æ„Ÿæƒ³
å‹•çš„ãªarrayã‚ˆã‚Šã‚‚ã€é™çš„ãªswitchã®æ–¹ãŒæ—©ã„ã¨æ€ã£ãŸãŒçµæžœã¯é€†ã ã£ãŸã€‚